package com.dipak.dao;

import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.dipak.beans.UserLogin;
import com.dipak.connection.DBConnection;
import com.dipak.util.PasswordUtil;

public class UserLoginDao {
	
	public static boolean checkUser(UserLogin user) throws ClassNotFoundException, IOException, SQLException
	{
		
		
		Connection con=DBConnection.getConnection();
		
		//PasswordUtil pass=new PasswordUtil();
		
		String query="SELECT key , salt FROM  userregister WHERE username="+user.getUseremail()+"";
		
				boolean flag=PasswordUtil.verifyUserPassword(user.getPassword(),key,salt);
		
		
		
 PreparedStatement ps = 
con.prepareStatement"select useremail, ukey , salt from userregister where useremail =?"));
		       
			ps.setString(2, user.getUsername());
		      ps.setString(4, user.getPassword());

		            System.out.println(ps);
		            ResultSet rs = ps.executeQuery();
		            rs.next();
		
		
		
		return flag;
		
	}
	

}
