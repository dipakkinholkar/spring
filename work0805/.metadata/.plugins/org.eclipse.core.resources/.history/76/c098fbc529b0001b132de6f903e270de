package com.dipak.dao;

import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.dipak.beans.UserLogin;
import com.dipak.connection.DBConnection;
import com.dipak.util.PasswordUtil;

public class UserLoginDao {
	
	public static boolean checkUser(UserLogin user) throws ClassNotFoundException, IOException, SQLException
	{
		
		
		Connection con=DBConnection.getConnection();
		
		//PasswordUtil pass=new PasswordUtil();
		
		String query="SELECT key , salt FROM  userregister WHERE username='"+user.getUsername()+"'";
		
		Statement st=con.createStatement();

		//to execute query
		ResultSet rs=st.executeQuery(query);

		String key=rs.getString(6);
		String salt=rs.getString(7);
		boolean flag=PasswordUtil.verifyUserPassword(user.getPassword(),key,salt);
		
		
		
		
		return flag;
		
	}
	

}
